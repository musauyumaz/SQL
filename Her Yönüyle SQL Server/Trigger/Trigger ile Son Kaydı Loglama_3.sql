USE [HR]
GO
/****** Object:  StoredProcedure [dbo].[GENERATE_WORKER_TRANSACTION]    Script Date: 13.04.2020 18:35:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
CREATE PROC [dbo].[GENERATE_WORKER_TRANSACTION]
@WORKERID AS INT
AS
BEGIN
DECLARE @I AS INT=0
DECLARE @BEGDATE AS DATETIME='2019-01-01 08:00:00'
DECLARE @IOTYPE AS VARCHAR(1)='G'
DECLARE @DATE AS DATETIME=@BEGDATE
	WHILE @I<365

		BEGIN
			IF DATEPART(DW,@BEGDATE)<>1 AND RAND()>0.2
			BEGIN
			--SABAH GÝRÝÞ 
			SET @DATE=DATEADD(MINUTE,CONVERT(INT,RAND()*30),@DATE)
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'G',ROUND(RAND()*20,0)) 
 
			--ÝLK MOLA ÇIKIÞ SAATÝ SAAT 10:00
			SET @DATE=DATEADD(HOUR,2,@BEGDATE)
			SET @DATE=DATEADD(MINUTE,CONVERT(INT,RAND()*15),@DATE)

			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'C',ROUND(RAND()*20,0)) 

			--ÝLK MOLADAN GELÝÞ
			SET @DATE=DATEADD(MINUTE,8+CONVERT(INT,RAND()*10),@DATE)
 
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'G',ROUND(RAND()*20,0))
 
			 --ÖÐLE YEMEÐÝNE ÇIKIÞ 12:00
			SET @DATE=DATEADD(HOUR,4,@BEGDATE)
			SET @DATE=DATEADD(MINUTE,CONVERT(INT,RAND()*15),@DATE)
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'C',ROUND(RAND()*20,0))
			--ÖÐLE YEMEÐÝNDEN GELÝÞ
			SET @DATE=DATEADD(MINUTE,55+CONVERT(INT,RAND()*15),@DATE)
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'G',ROUND(RAND()*20,0)) 

			 --ÝKÝNCÝ MOLAYA ÇIKIÞ YEMEÐÝNE ÇIKIÞ 15:00
			SET @DATE=DATEADD(HOUR,7,@BEGDATE)
			SET @DATE=DATEADD(MINUTE,CONVERT(INT,RAND()*15),@DATE)
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'C',ROUND(RAND()*20,0)) 
			--ÝKÝNCÝ MOLADAN GELÝÞ
			SET @DATE=DATEADD(MINUTE,8+CONVERT(INT,RAND()*10),@DATE)
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'G',ROUND(RAND()*20,0)) 

			 --MESAÝ BÝTÝÞÝ 17:00
			SET @DATE=DATEADD(HOUR,9,@BEGDATE)
			SET @DATE=DATEADD(MINUTE,-10+CONVERT(INT,RAND()*20),@DATE)
			INSERT INTO HR.DBO.WORKERTRANSACTIONS (WORKERID,DATE_,IOTYPE,GATEID)
			VALUES (@WORKERID,@DATE,'C',ROUND(RAND()*20,0))
		
		END
		SET @I=@I+1
 
		SET @BEGDATE=DATEADD(DAY,1,@BEGDATE)
 
	
 END

END 